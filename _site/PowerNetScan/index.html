<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.1 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>PowerNetScan - r2alter blog</title>
<meta name="description" content="Introduction">


  <meta name="author" content="r2alter">
  
  <meta property="article:author" content="r2alter">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="r2alter blog">
<meta property="og:title" content="PowerNetScan">
<meta property="og:url" content="http://localhost:4000/PowerNetScan/">


  <meta property="og:description" content="Introduction">







  <meta property="article:published_time" content="2025-01-12T00:00:00+01:00">





  

  


<link rel="canonical" href="http://localhost:4000/PowerNetScan/">












<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="r2alter blog Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script type="text/javascript">
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          r2alter blog
          <span class="site-subtitle">Some words about my projects</span>
        </a>
        <ul class="visible-links"></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/images/r2_logo.jpg" alt="r2alter" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">r2alter</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Red teamer and privacy enthusiast.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="mailto:r2alter@tuta.io" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/r2alter" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="PowerNetScan">
    <meta itemprop="description" content="Introduction">
    <meta itemprop="datePublished" content="2025-01-12T00:00:00+01:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="http://localhost:4000/PowerNetScan/" itemprop="url">PowerNetScan
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <h2 id="introduction">Introduction</h2>

<p>There are so many TCP scanners available on the web. So why did I write another one? During Red Teaming operations or certification exams like OSEP or OSED I made a lot of network scans. Of course, the first choice is Nmap. The king is only one.</p>

<p>But when I am inside Active Directory Domain and I want to scan inside the network, I have two options: tunneling or using Windows tools. Tunneling network traffic for scanning is not reliable enough (my private opinion only).</p>

<p>So I have to use some Windows tools. To install additional software, it is required to gain Administrator privileges. Using portable Nmap is often marked as malicious behavior. The last chance to do it easily is to use PowerShell.</p>

<p>There are so many open-source PowerShell port scanners. But anyone meet my requirements. Different command syntax (reminder - Nmap is the king), slow scanning, and truncated output are the usual problems. </p>

<p>So… I had to create my own port scanner, which works well for me.</p>

<h2 id="usage">Usage</h2>
<p>Adding the command to a PowerShell session is so simple.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(New-Object System.Net.WebClient).DownloadString('https://raw.githubusercontent.com/r2alter/PowerNetScan/main/PowerNetScan.ps1') | IEX
</code></pre></div></div>

<p>And just execute <strong>Invoke-TCPPortScan</strong> command. Targets can be defined using parameters <em>Hosts</em> <strong>OR</strong> <em>HostsFile</em>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-TCPPortScan -Hosts google.com
</code></pre></div></div>

<p>I wanted to create similar command syntax to Nmap basic invoking. So you can use the following parameters:</p>
<ul>
  <li>Hosts (Object) - provide IP addresses, IP address ranges (like Nmap) and hostnames separate it by comma. If used <strong>FileHosts</strong> parameters cannot be used.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-TCPPortScan -Hosts google.com,172.16.209.128-130,172.16.10.2
</code></pre></div>    </div>
  </li>
  <li>HostsFile (Object) - provide a path to the file where targets are written line by line. If used <strong>Hosts</strong> parameters cannot be used.</li>
  <li>Ports (Object) - like always, TCP ports to scan, also ranges, and single ports separated by commas. If not provided, the top 250 ports from Nmap will be scanned.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-TCPPortScan -Hosts google.com -Ports 80,82,441-446
</code></pre></div>    </div>
  </li>
  <li>Timeout (float) - How many seconds wait for a response from each port.</li>
  <li>Threads (int) - How many threads will be used for scanning. Nice to improving performance.</li>
  <li>ShowScope (switch) - If you want to see the whole scanning scope after input formatting and resolving DNS. Useless without <strong>Verbose</strong> switch.</li>
  <li>ConsoleOutput (switch) - everything is written to the console. Default output type.</li>
  <li>ObjectOutput (switch) - If choosen results of the scan are returned as object.</li>
  <li>FileOutput (String) - Save results of scan to file.</li>
</ul>

<p>and common parameters. Important is the <strong>Verbose</strong> parameter which shows what is happening in background and allows checking live results.</p>

<h2 id="valuable-features">Valuable features</h2>

<p>Script performs DNS resolving during format input stage. If the hostname has more than one IP address, all addresses will be added to scope.
<img src="/assets/images/DNS_feature.png" alt="DNS feature" /></p>

<p>Possibility to track live results and also have results saved in variable.
<img src="/assets/images/live_results_feature.png" alt="live results feature" /></p>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2025-01-12T00:00:00+01:00">January 12, 2025</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=PowerNetScan%20http%3A%2F%2Flocalhost%3A4000%2FPowerNetScan%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2FPowerNetScan%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/PowerNetScan/" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You may also enjoy</h2>
  <div class="grid__wrapper">
    
      
  </div>
</div>

  
</div>

      
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/r2alter" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 <a href="http://localhost:4000">r2alter blog</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>









  </body>
</html>
